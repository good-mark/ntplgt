
          ﻿h
Розглядаеться режим eu6ipKoeo-го гамування i3 прискореним виробленням iMimoecmaeKU (Galois/Counter Mode and GMAC), специфшащю якого наведено у стан-дартi NISTSP 800-38D. Розробляеться змен-шена модель режиму, яка зберкае алгебрагчну структуру вых основних криптоперетворень та дозволяе за рахунок гхнього масштаб-ування провести експериментальт дослiд-ження колiзiйних властивостей формованих iмiтовставок з подальшим прогнозуванням рiвня криптографiчного стiйкостi повног вер-си шифру
Ключовi слова: мт^верЫя режиму шиф-рування, моделювання, iмiтовставка, полi-номiальне Гешування, блоковый симетричний шифр
□-□
Рассматривается режим выборочного гаммирования с ускоренной выработкой ими-товставки (Galois/Counter Mode and GMAC), спецификация которого представлена в NIST SP 800-38D. Разрабатывается уменьшенная модель режима, которая сохраняет алгебраическую структуру всех основных крипто-преобразований и позволяет за счёт их масштабирования провести экспериментальные исследования коллизионных свойств сформированных имитовставок с последующим прогнозированием уровня криптографической стойкости полной версии шифра
Ключевые слова: мини-версия режима шифрования, моделирование, имитовставка, полиномиальное хеширование, блочный симметричный шифр
УДК 004.056.55
|DOI: 10.15587/1729-4061.2014.278881
МОДЕЛЮВАННЯ РЕЖИМУ ВИБ1РКОВОГО ГАМУВАННЯ 13 ПРИСКОРЕНИМ ВИРОБЛЕННЯМ 1М1ТОВСТАВКИ
О. О. Кузнецов
Доктор техшчних наук, професор Кафедра безпеки шформацтних систем та технолопй Хармвський нацюнальний ушверситет iM. В. Н. Каразша пл. Свободи, 4, м. Хармв, УкраТна, 61022 E-mail: kuznetsov_alex@rambler.ru £. П. Колованова Старший викладач* E-mail: e.kolovanova@gmail.com Д. В. 1ваненко Кандидат техшчних наук, старший викладач* E-mail: i8o.dima@gmail.com О. А. Винокурова Доктор техшчних наук, професор* E-mail: vinokurova@kture.kharkov.ua *Кафедра безпеки шформацшних технолопй Хармвський нацюнальний ушверситет радюелектрошки пр. Ленша, 14, м. Хармв, УкраТна, 61166
1. Вступ
Для забезпечення безпеки шформацшних та ко-мушкацшних систем зазвичай застосовуються pi3Hi мехашзми захисту, зокрема блокове симетричне шифрування. Його сутшсть полягае у перетворенш вщкритоТ шформацп з використанням спещальних ключових даних з метою приховування шформа-цшного змшту повщомлення, шдтвердження його справжноси, цШсноси, авторства, тощо [1-3]. Вим ефектившсть криптографiчного захисту шформацп визначаеться не лише властивостями блокового си-метричного шифру, але i способами його викори-стання, тобто режимом застосування симетричних криптоперетвореннь [1-4].
Для забезпечення щлшност та конфщенцшност шформацп призначено режим вибiркового гамування iз прискореним виробленням iмiтовставки, що за мiжнародною термiнологiею позначаеться як Galois/Counter Mode and GMAC (GCM&GMAC) та який специфжовано у стандарт NIST SP 800-38D [4]. Цей
режим призначено для реалiзащi швидкого крипто-перетворення при забезпеченнi послуг безпеки ш-формацii iз використанням рiзних криптографiчних примiтивiв, зокрема полiномiального Гешування, гамування, тощо [8-25]. 1мплементащя положень режиму GCM&GMAC для застосування в Украшу його дослiдження та аналiз певних властивостей е надзвичайно важливою та актуальною задачею, яка тшно пов'язана iз розробкою проекту нащонального стандарту ДСТУ «1нформацшш технологи. Крипто-графiчний захист iнформацii. Алгоритм симетрично-го блокового перетворення» [5, 6].
2. Аналiз лiтературних джерел i постановка проблеми дослщження
Режим GCM&GMAC був стандартизований нащо-нальним шститутом стандартiв i технологiй (NIST) [4, 16] та призначений для використання в поеднанш
з 128-биним блочним шифром для забезпечення ав-
тентичност та, B^ipKOBO, конфiденцiйностi шфор-мацп. У поeднаннi з алгоритмом шифрування AES [8] у виглядi спецiальноï функцiï AES-GCM цей режим був використаний для замши алгоритму HMAC [12] в популярних кpиптогpафiчних протоколах, таких як SSH [13], IPSec [14] i TLS [15].
Враховуючи певш особливост режиму GCM&GMAC слщ вiдмiтити його надзвичайно ви-соку швидкодж [17-22]. Оскiльки цей режим мае м^мальну затримку i м^мальну кiлькiсть викону-ваних опеpацiй вш iдеально пiдходить для захисту пакеив даних, зокрема в piзних телекомушкацшних протоколах. Так для pеалiзацiï режиму GCM&GMAC при обробщ одного 128 биного блоку даних потpiбно виконати лише одне шифрування та одне 128-бине множення в полi Галуа. При цьому операцп блокового шифрування легко конвейерувати та розпарале-лювати. Кpiм того коpпоpацiя Intel додала шструк-цiю PCLMULQDQ, видiливши ïï для використання GCM & GMAC [17]. Ця шструкщя призначена для швидкого множення у полi Галуа GF(2n), що значно прискорюе pеалiзацiю режиму GCM&GMAC.
Вpажаючi результати продуктивноси були також опублiкованi для режиму GCM & GMAC на pядi шших платформ. Так у [18] отримано 10,68 циклiв на байт при обчисленш iмiтовставки на 64-розряд-них процесорах Intel. У [19] повщомляеться про 3,5 циклiв на байт для того ж алгоритму при викори-станш iнстpукцiï AES-NI i PCLMULQDQ корпорацп Intel. На процесорах 3-го поколшня Intel iз викори-станням бiблiотек OpenSSL i NSS у [20] досягаеться продуктившсть 2,47 циклiв на байт. За рахунок використання команд паpалелiзму у [21] можливо зб^ьшення пpодуктивностi режиму GCM & GMAC, оптимiзована pеалiзацiя запропонована у [22].
Захищенiсть режиму GCM&GMAC було пе-pевipено в конкретнш моделi безпеки [23]. При цьому повинен використовуватися блочний шифр, властивоси якого не вiдpiзняеться вщ властиво-стей випадковоï пiдстановки. Проте безпека режиму залежить не лише вщ властивостей застосовува-ного шифру, але i вщ вибору ушкальних вектоpiв iнiцiалiзацiï для кожного шифрування, виробле-ного з тим же ключем. Для будь-якоï заданоï ком-бiнацiï ключа i вектора iнiцiалiзацiï, застосування режиму GCM&GMAC обмежуеться шифруванням 239-256 бiт вiдкpитого тексту. NIST Special Publication 800-38D включае кеpiвнi принципи для вибору вектора iнiцiалiзацiï [4].
У [24] описано як зловмисник може виконати оптимальнi напади на режим GCM&GMAC, як вщ-повщають нижнiй межi його безпеки.
В [25] описано наявшсть т. з. «слабких» ключiв режиму GCM&GMAC. Однак ця робота не показуе б^ьш ефективну атаку, шж pанiше вщомь
У pоботi [7] розглянуто випадок шнування «слабких» ключiв, якi призводять до виpодженоï роботи функцiï Гешування, в наслiдок чого формован iмiтовставки не залежать вiд вихщних даних, '¿х колiзiйнi властивостi порушуються i не вщповща-ють теоретичним ощнкам. 1снування «слабких» ключiв режиму GCM&GMAC вщповщае випадку формування нульового субключа полiномiального Гешування в схемi GCM&GMAC, який виникае при
наявност т. з. «фiксованих точок шифру», тобто таких ключiв, якi шифрують нульову послiдовнiсть саму у себе. Отримаш у [7] теоретичнi ощнки показали, що ймовiрнiсть тако1 подii не залежить вiд довжини ключа, вона визначаеться лише довжиною блокiв даних, якi обробляе шифр. Вщповщна ем-пiрична оцiнка числа колiзiй передбачае застосування зменшених моделей шифрiв, зокрема, моделюван-ня режиму вибiркового гамування iз прискореним виробленням iмiтовставки.
Метою дослiдження в цш роботi е розробка зменшеноi моделi режиму вибiркового гамування iз прискореним виробленням iмiтовставки шляхом масштабування кожного з етапiв перетворень. Не-обхiдно побудувати таку зменшену модель режиму GCM&GMAC, в якiй на кожному з еташв перетворень збертлася iх алгебраiчна структура iз вщ-повiдною вiдтворюванiстю результатiв. Це надасть змогу провести емшричш дослщження колiзiйних властивостей формованих iмiтовставок iз прогно-зуванням рiвня криптографiчного стшкост повноi версii шифру, експериментально перевiрити отри-манi у [7] теоретичш оцiнки числа колiзiй.
3. Аналiз режиму вибiркового гамування i3 ПрИСКОреНИМ ВИроблеННЯМ ÎMÎTOBCTaB^ В1ДПОВ1ДНО до NIST SP 800-38D
Розглянемо основш перетворення режиму GCM&GMAC, зокрема проаналiзуeмо Bci застосову-ванi криптографiчнi примiтиви на можлившть 1хнього масштабування для проведення експериментальних дослщжень колiзiйних властивостей формованих iмiтовстовок.
Для забезпечення конфiденцiйностi вщкрито-го тексту Р застосовуеться функщя GCTRK - деяка варiацiя режиму гамування [1-4, 16-22], де перший блок лiчильника для зашифрування вщкритого тексту генеруеться шляхом збiльшення (inc32) блоку лiчиль-ника J0 , сформованого з вектору iнiщалiзащi IV. Для забезпечення щлкност застосовуеться шший мехаш-цизм, який засновано на функцп Гешування GHASHh. Функцiю GHASHh побудовано iз використанням полiномiальноi схеми i реалiзовано через множення на фжсований параметр, який названо субключем Гешування H, з операцiями в двшковому полi Галуа. Функцiю Гешування використовують для стискан-ня додаткових автентифжованих даних A (Additional Authenticated Data - AAD) та шифртекст у С в единий блок, який далi проходить зашифрування для створен-ня тегу автентифжацп Т ^миовставки).
Зашифрування та формування тегу автен-тифiкацii (iмiтовсавки) виконуеться функщею GCM - AEK(IV, P, A) = (C,T) , структурну схему об-числення я^ наведено на рис. 1 [4], де позначення 0s визначае рядок довжини s, який складаеться з бтв '0'; len(X) - бiтова довжина рядка X; функщя [x]s повертае бiнарне представлення x як рядка бiтовоi довжини s; функцiя MSBs(X) повертае s найбiльш значущих би-iв X; CIPH - затверджений 128-биний блоковий симе-тричний шифр.
Розглянемо алгоритм зашифрування та отримання тегу (коду) автентифжацп ^мгговставки) [4].
u = 128|"len(C)/128]-len(C) , v = 128[len(A)/128~|-len(A) .	(6)
5) Визначити блок S наступним чином:
S = GHASHH Х
х^A |0v|| C I) 0u
6)	Нехай
T = MSBt(GCTRK(J0,S)).
7)	Повернути (C, T).
Den(A)]J [len(C)] J .(7)
(8)
Зворотне перетворення реал1зуеться Рис. 1. Структурна схема роботи алгоритму зашифрування та отримання функц^ею GCM-АЕкО^ P, A) = (C,T)
тегу автентифкаци
Алгоритм GCM-AEK (IV, Р, А)
Передумови:
затверджений блоковий шифр С1РНз 128-бгтним розмгром блоку; ключ К;
визначення дозволених довжин вхгдних-вихгдних даних;
дозволена довжина тегу ^ зв'язаного з ключем. Вих1дн1 дат:
вектор 1нщ1ал1зац1г IV (дозволеног довжини);
вгдкритий текст Р (дозволеног довжини);
додатковг автентифгкованг дат А (дозволеног довжини). Вих1дн1 дат:
шифртекст С; тег автентифгкацгг Т. Кроки:
Формування субключа Гешування для функцгг GHASHH
та полягае в пеpевipцi справжност шифр-тексту С iз додатковими автентифжовани-ми даними A. Структурну схему обчислення функцп GCM - AEK(IV, P, A) = (C,T) наведеною на рис. 2 [4]. При тдтвердженш справжност (знов обчислений тег автентифжаци Т' доpiвнюе отриманому Т) виконуеть-ся розшифрування шифртексту С та формуеться ввд-критий текст Р.
Як видно з рис. 1, 2 основними перетвореннями нового режиму Galois/Counter Mode and GMAC е Гешування даних iз використанням функцп GHASHh та зашифрування/розшифрування функщею GCTRK. Розглянемо '¿х б^ьш детально.
1) H = CIPHK (0128).
(1)
H
H
i
lIKj;
GCTR*
*
0"
[1епМ]ы
[1сп(0)м
GHASH,,
2) Визначити блок J0 з вектору im-
щал1зацй IV:
Якщо len(IV) = 96, тодi
GCTRr
MSB,
1
CIP1I
f
H
J0 = IV 031 1.
(2)
и
if»
Якщо len (IV) Ф 96, тодi s = 128 [len(IV) /128]- len(IV), (3)
I
FAIL
Рис. 2. Структурна схема роботи алгоритму розшифрування
J0 = GHASHh(IV ||0s+641| [len(IV)]64).	(4)
3)	Отримання шифртексту С
C = GCTRk (inc32 ( J0 ), P).	(5)
4)	Нехай
3. 1. Шифрування за допомогою функцп GCTRK з використанням блокового симетричного шифру AES
На рис. 3 зображено структурну схему обчислення функцiï GCTRK для pеалiзацiï зашифрування/розшифрування, де ICB - початковий блок лiчильника; CBi - i-ий блок лiчильника; inc - функцiя iнкpе-
ментацп. Зашифрування вiдбуваeться за допомогою функцп CIPHK - блокового симетричного шифру AES 3i 128-бiтним розмiром блоку з використанням ключа шифрування K довжиною 128 бтв.
ICB	-*	inc	-	св7	-* ... -*	СВ„	-	inc	-	св„
4
CIPH.
CIPH,
С1РН,
н-
• ф
ы-
Н
Рис. 3. Структурна схема обчислення функци шифрування
Розглянемо алгоритм зашифрування повщомлен-ня за допомогою функцп GCTRk [4]. Алгоритм GCTRK (ICB, X)
Передумови:
затверджений блоковий симетричний шифр CIPH (у даному випадку це блоковий симетричний шифр AES) 3i 128-бтнимрозмiром блоку; ключ К довжиною 128 бiтiв. Вхiднi дат:
початковий блок лгчильника ICB; бтовий рядок X, довшьног довжини. Вихiднi дат:
бтовий рядок Yбтовог довжини len(X) - довжини
рядка Х.
Кроки:
1)	Якщо X е пустим рядком, тодi повернути пустий рядок як Y.
2)	Визначення кiлькостi блотв довжиною 128 бiтiв n = |"len (X) /128].	(9)
3)	Нехай X1,X2,... , Хп-1,ХП визначае уткальт послiдовностi бтових рядтв таких, що
X = X1IX2I Xn_i|xn,	(10)
причому Х1Д2,... , Xn
_1	xn
«частковий» блок.
4)	Нехай CB1 = ICB.
5)	For i=2 до n
CB, = inc32 (CBi_1).	(11)
6)	For i = 1 до n-1
Y, = X, © CIPHK(CB,).	(12)
7)	Y; = Xn фMSBlen(X,)(CIPHK(CBn)).
8)	Формування зашифрованого повгдомлення
Y = YJY2I К |Y;_^|Y;.	(13)
У якост затвердженого блокового симетричного шифру використовуеться шифр AES [8].
3. 2. Ушверсальне Гешування з використанням полшомiально¡ схеми Горнера
Для забезпечення щлшност iнформацii використовуеться функщя Гешування GHASHh [4], структурна схема И обчислення зобра-жена на рис. 4. Цю функцiю побудовано на основi полiномiальноi схеми [10] та реалiзовано за допомогою множення на фжсований параметр - субключ. Ii призначено для стискання шифртексту та додаткових автентифiкованих даних в единий блок. В« операцп проводять-ся в двiйковому полi Галуа. На вхiд функцii подаеться деяка ушкальна по-слiдовнiсть блоюв довжиною 128 бiтiв кожний, Геш-значенння розраховуетьз ся з використанням схеми Горнера.
Рис. 4. Структурна схема обчислення функци Гешування
Розглянемо алгоритм роботи функцп Гешування GHASHH.
Алгоритм GHASHH
Кроки:
1)	Нехай Х4, Х2,... , Хт-1, Хт визначае унжальну по-сл1довн1сть блокгв, таку, що
Х=Х1 ||Х21| ... ||Хт.	(14)
2)	Нехай У0 буде «нульовим блоком», 0128
3)Для	\ = 1,...,т, нехай у = (Ум ФХ>Н.
4)	Повернути Ут.
Таким чином функщя GHASHH розраховуе
Ут = Х^Нт ФХ^Н1"-1 Ф...ФХт_1 •Н2ФХт^Н\ (15)
Де Х1, Х2,... , Хт_1, Хт - послiдовнiсть блокiв повщом-лення, Н - субключ Гешування.
Функщя Гешування перетворюе вхвдш поввдомлен-ня, довжина яких е кратною 128 (це довжина блоку), та стискае 1х до загального розмiру (довжини) 128 бiтiв.
Необхщно зазначити, що субключ Гешування Н отримано зашифруванням "нульового" вектору довжиною 128 бтв за допомогою блокового симетричного шифру AES на деякому ключi К. Детально процес шифрування розглянуто у [8].
Використана функщя Гешування за полiномiаль-ною схемою Горнера належить до класу ушверсальних Геш-функцш [9, 10].
Проведений аналiз основних перетворень режиму B^ipKOBoro гамування i3 прискореним виробленням ÎMiTOBCTaB^ показав, що структура GCM&GMAC складаеться i3 декiлькoх шаpiв: шифрування у pежимi лiчильника вибipкoвих даних, пoлiнoмiальне Гешування отриманих шифртекспв, шифрування у pежимi лiчильника формованого Геш-значення. Тобто режим GCM&GMAC мае прозору алгебpаïчну структуру, яка може бути масштабована шляхом зменшення розряд-носи вщповщних вектopiв вiдкpитoгo тексту, ключа, шифртексту та Геш-значення.
Таким чином, моделювання режиму вибipкoвoгo гамування i3 прискореним виробленням iмiтoвставки через розробку зменшенoï (мт) версп основних перетворень надасть змогу провести експериментальш дoслiдження кoлiзiйних властивостей формованих iмiтoвставoк iз прогнозуванням piвня кpиптoгpафiч-ного стiйкoстi пoвнoï версп шифру, експериментально пеpевipити отримаш у [7] теopетичнi oцiнки числа кoлiзiй та надати oбгpунтoванi рекомендацп по засто-суванню режиму GCM&GMAC в Украшг
4. Розробка зменшено'1' (mïhï) моделi режиму вибiркового гамування i3 прискореним виробленням iмiтовставки вщповщно до NIST SP 800-38D
Розглянемо зменшену модель формування кoдiв автентифжацп пoвiдoмлень mini-GMAC, яка при збе-pеженнi математичнoï структури основних перетво-рень за рахунок зменшення ключового простору та простору автентифiкатopiв дозволяе oцiнити юльюсть виникаючих кoлiзiй.
Схема формування кoдiв автентифiкацiï повщом-лень GMAC використовуе в свош стpуктуpi декiлька етатв перетворень (в тому числi блоковий симетрич-ний шифр AES). Зменшена модель GMAC мае вклю-чати вщповщш етапи перетворень зi збереженням '¿х алгебpаïчнoï структури при виконанш масштабування до мiнi-веpсiï.
Загальна схема формування кoдiв GMAC складаеться з таких основних етатв:
-	отримання субключа Гешування H за допомогою блокового симетричного шифру mini-AES;
-	формування блоку J0 з вектору iнiцiалiзацiï IV;
-	формування шифртексту C з використанням функцп GCTRK;
-	ушверсальне Гешування шифртексту C та до-даткових автентифжованих даних iз застосуванням функцп GHASHh для формування единого кшцевого блоку (Геш-коду);
-	кpиптoгpафiчне перетворення з використанням блокового симетричного шифру AES для зашифруван-ня кшцевого блоку iз застосуванням функцп GCTRK та блоку J0;
-	заключне перетворення для формування тегу автентифжацп повщомлень шляхом oбpiзання результату шифрування до визначенoï довжини t.
Розглянемо кожен етап схеми формування кoдiв автентифжацп пoвiдoмлень mini-GMAC. Побудуемо мшьвераю схеми формування кoдiв автентифiкацiï повщомлень без змiни структури алгебpаïчних перетворень звичайним зменшенням poзмipнoстi блоюв оброблюваних даних у вiсiм pазiв. Таким чином, дов-
жина кожного блоку складатиме 16 бтв, тобто ва розрахунки ведуться в кшцевому пoлi Галуа GF(216). Вiдпoвiднo i довжина Геш-коду зменшенoï мoделi буде дopiвнювати 16 бiтам.
4. 1. Отримання субключа Гешування H за допомогою блокового симетричного шифру mini-AES
Згщно з рисунком 1 на першому етат для функцп GHASHh пoвнoï версп режиму вибipкoвoгo гамування iз прискореним виробленням iмiтoвставки генеруеть-ся субключ Гешування H iз застосуванням блокового шифру AES на вхщному ключi K до "нульового" блоку (вираз (1)).
Для отримання субключа Гешування H в змен-шенш мoделi mini-GMAC будемо застосовувати схему mini-AES, яка докладно описана в [11]. Тобто будемо застосовувати довжину ключа K та довжину "нульово-го" блоку у 16 бтв.
Розглянемо формування субключа H на прикладь Нехай K = 11110100 00001110. Застосуемо вщповщно до [11] блоковий шифр mini-AES на вхщному ключi K до "нульового" блоку O = 0000 0000 0000 0000. Отри-муемо субключ Гешування H = 0110 110110011000.
4. 2. Формування блоку J0 з вектору iнiцiалiзацiï IV
На другому етат роботи алгоритму формуеться блок J0 з вектору iнiцiалiзацiï IV. Застосуемо той са-мий коефщент масштабування, що i в п. 3. 1, зокрема, коли довжина вектору iнiцiалiзацiï IV дopiвнюе 12 бггам, тoдi для створення блоку J0 вектор iнiцiалiзацiï IV доповнюеться конкатенащею рядком 03||1 згщно з (2). В шшому випадку вектор iнiцiалiзацiï IV заповнюеть-ся мжмальним числом "нульових" бiтiв, таким чином, щоб довжина результуючого рядка була кратною 16 биам (poзмipу блоку), цей рядок в свою чергу до-даеться до 8 додаткових "нульових" бтв, тсля яких йде 8-бине представлення довжини вектору iнiцiалiзацiï IV, та функцiя GHASHh застосовуеться до результуючого рядка для створення блоку J0. Тобто згщно з (4)
J0 = GHASHh (iv||0s+8| |[len (IV)] 8 ), де вiдпoвiднo до (3)
s = 16 |"len (IV)/ 16]- len (IV)
Розглянемо формування блоку J0 з вектору irn-цiалiзацiï IV на прикладь
Спочатку розглянемо випадок, коли довжина вектору iнiцiалiзацiï IV дopiвнюе 12 бгтам, тобто
len (IV) = 12, IV = 0100 0100 0100, тoдi
J0 = IV||03||1 = 0100 0100 0100||000||1 = 0100 0100 0100 0001.
Розглянемо випадки, коли len (IV) ф12.
1) Нехай
len(IV) = 8, IV = 0100 0100.
s = 16-[8/16]-8 = 8, [len (IV)] =[8]8 = 0000 1000, Jo = GHASHh (IV||08+8| |[8]e ) =
текст та початковий блок лiчильника, який в свою чергу формуеться iз застосуванням функцп шкрементацп до блоку лiчильника - вираз (5). Для збереження масшта-буючого коефiцiенту до блоку J0 застосуемо 4-бину = GHASHн (01000100||0000000000000000|00001000), функвдю шкрементацп. Результатом роботи функцп тобто маемо	т1ш^СТЯК iз використанням ключа К е шифртекст С.
Розглянемо роботу 4-бггно'! функцп шкремента-J0 = GHASHH (0100 0100 0000 0000 0000 0000 0000 1000). цп до блоку J0 , сформованого з вектору iнiцiалiза-
Застосувавши функцiю Гешування GHASHh (алгоритм роботи яко1 буде докладно розглянутий тзшше), отримаемо шуканий блок J0
J0 = 0101.11101 1111 0000.
2) Нехай
len(IV) = 16, IV = 0100 0100 0100 0100, тодi
s = 16 -[16/16]-16 = 16-1 -16 = 0, [len (IV)] = [16]8 = 0001 0000,
J0 = GHASHh (IV||00+8| |[16]8 ) = = GHASHH (0100010001000100||00000000||00010000),
тобто маемо
цп IV, причому len (IV) = 12.
inc4 (Jo) = MSBien(j0 )_4 (Jo )|[int (LSB4 (Jo)) +1 mod 24 ] =
= MSB16-4 (Jo )|[int (LSB4 (Jo)) + 1mod24 ]4 =
= MSB12 (Jo )|[int (LSB4 (Jo)) + 1mod24 ^,
де MSBs (Jo) - функщя, яка для заданого бггового рядка Jo повертае s найменш значущих (тобто най-правiших) бiтiв Jo ; LSBs (Jo) - функщя, яка для заданого битового рядка Jo повертае s найбiльш значущих (тобто найлiвiших) бiтiв Jo ; int (Jo) - функцiя, яка представляе биовий рядок Jo як щле число; [x]s функцiя, яка повертае бшарне представлення x як рядка биово1 довжини s з найменш значущим бiтом праворуч.
Нехай
Jo = o1oo o1oo o1oo ooo1,
J0 = GHASHH (0100 0100 0100 0100 0000 0000 0001 0000). тодi
Застосувавши функцiю Гешування GHASHH, отримаемо шуканий блок J0
J0 = 0010 0001 1010 0000.
3) Нехай
len (IV) = 20, IV = 0100 0100 0100 0100 0100,
тодi
s = 16 -[20/16]-20 = 16 - 2 - 20 = 12, [len (IV)] = [20]8 = 0001 0100, J0 = GHASHh (IV||012+8|| [20] 8 )=
MSB12 (Jo) = o1oo o1oo o1oo , LSB4(Jo) = ooo1, int (LSB4 (Jo )) = int (ooo1) = 1,
[int (LSB4 (Jo)) + 1mod24 = = [int (ooo1) +1 mod 24 ] = [1 + 1mod 24 ] =
= [ 2 ] 4 = 0 010,
inc4 (Jo ) = o1ooo1ooo1oo oo1o.
Розглянемо алгоритм отримання шифртексту, тобто роботу функцп mini-GCTRK
= GHASHH (01000100010001000100||00000000000000000000||00010100),
C = GCTRK(inc4 (J0),P),
тобто маемо
J0 = GHASHH (010001000100010001000000000000000000000000010100). де P - вiдкритий ^^
P = 0011 0011 0011 0011 1100 1100 1 100 1100 ;
Застосувавши функщю Гешування GHASHH, отримаемо блок J0
J0 = 1100 0000 1111 0111.
K - ключ шифрування, K = 1111 0100 0000 1110.
1) Визначимо юльюсть блоюв, на яю розбиваеться 4. 3. Формування шифртексту C з використанням вщкритий текст з урахуванням коефвденту масштабу-
функцп mini-GCTRK
Наступним кроком е формування шифртексту. Для цього на вхвд функцп GCTRK подаеться вiдкритий
вання та (9)
n = [len (P)/16] = [32/16] = 2 .
2)	Рoзiб'емo вщкритий текст на 2 блоки вщповщно до (10)
P = P1IP2-
Тoдi
P1 = 0011 0011 0011 0011, P2 = 1100 1100 1100 1100.
3)	Формуемо послщовшсть блоюв лiчильника (ви-раз (11))
CB1 = inc4 (J0) = 0100 0100 0100 0010, CB2 = inc4 (CB1 ) = 0100 0100 0100 0011.
4)	Формуемо шифртекст C вщповщно до (12) та (13) C = C1IC2,
де
C1 = P1ФCIPHK(CB1 ), C2 = P2 ФCIPHK(CB2),
блок S побудуемо наступним чином з урахуванням кoефiцiенту масштабування та виpазiв (6) та (7):
S = GHASHH (a||0v ||c||0u I|[len(A)]e ||[len(C)]8),
де
v = 16 -[len (A)/16]-len (A), u = 16 -[len (C)/16]- len (C).
Визначимо на пpикладi вхiднi данi для Гешування шифртексту C та додаткових автентифжованих даних iз застосуванням функцп mini-GHASHH.
Нехай субключ Гешування H = 1010 00011000 1110 , дoдаткoвi автентифжоваш данi A = 000100010001, довжина рядка додаткових автентифжованих даних len (A) = 12 , шифртекст
C = 1111 1001 1111 1100 0010 0110 0000 0101,
довжина рядка шифртексту len(C) = 32. Тoдi
v = 16-[12/16]-12 = 4, u = 16 [32/16]-32 = 0,
S = GHASHH (X),
CIPHK (CBj ) - застосування блокового симетричного шифру mini-AES з ключем шифрування K до де вщповщного блоку лiчильни-
ка CB,	X=a||04||C||0»|| [12]8||[16]8 =
Застосувавши шифр mini-
AES з ключем шифрування K до = 00010001000Ц0000||11000011110010010001110000111100||00001100|00010000 =
блoкiв лiчильника CB1 та CB2, = 0001000100010000110000111100100100011100001111000000110000010000.
отримуемо таю значення
CIPHK (CB1 ) = 1111 0000 11111010,
CIPHK (CB2 ) = 1101 0000 1111 0000, C1 = P1ф CIPHK (CB1 ) = =0011001100110011ф1111000011111010= = 1 100001 11 100 1001,
C2 = P2 ф CIPHK (CB2 ) = = 1100110011001100 ф1101000011110000 = =0001110000111100.
C=C1IC2 = = 1100001111001001||0001110000111100 = =11000011110010010001110000111100.
4. 4. Ушверсальне Гешування шифртексту C та додаткових автентифжованих даних iз застосуванням функцп mini-GHASHH
На наступному етат до додаткових автентифжо-ваних даних та шифртексту додаеться мжмальна юльюсть "нульових" бтв, так, щоб биова довжина результуючих pядкiв була кратною poзмipу блока. Пiсля цього отримаш рядки конкатенуються, а результат доповнюеться представленням додаткових автен-тифжованих даних та шифртексту. Функщя GH ASHH застосовуеться до отриманого результуючого рядка для створення единого кшцевого блоку S. Осюльки у зменшенш мoделi застосовуеться масштабування,
Розбиваемо X на n рядкiв згiдно з (14), де
n = len (X)/16 = 64/16 = 4, тобто
X	= Xi||X2||X3||X4.
XI	= 0001000100010000, X2 = 1100001111001001,
X3 = 0001110000111100, X4 = 0000110000010000.
Згiдно з рис. 4 та алгоритмом Гешування за допо-могою функцiï GHASHh значення кiнцевого блоку S обчислюеться за полiномiальною схемою. Визначимо зменшену ïï модель вiдповiдно до (15) наступним чином:
S = X1 ■ H4 Ф X2 ■ H3 Ф X3 ■ H2 © X4 ■ H1.
Виконуючи розрахунки у полi GF(216) отримаемо такий результат:
S = 0101 1110 0010 0011.
4. 5. Криптографiчне перетворення з використанням блокового симетричного шифру mini-AES для зашифрування кшцевого блоку i3 застосуванням функцп mini-GCTRK та блоку J0
На передостанньому етат отриманий стиснутий за допомогою функцп mini-GHASHH блок S зашифро-
вуеться iз застосуванням функцп mini-GCTRK з блоком J0 .
Застосуемо функщю mini-GCTRK з блоком J0 (алгоритм 11 роботи детально описаний рашше), де у якост вiдкритого тексту виступае стиснутий блок S, а результатом е зашифроване повiдомлення У.
Нехай, як i у попереднiх прикладах, вхiдними да-ними е:
J0 = 0100010001000001, К = 1111010000001110,
S = 01011110 00100011.
Тда згiдно з (9)-(13) маемо:
1)	п = |~1еп (S)/1б] = [1^1б"] = 1,
2)	S = S1 = 0101 1110 00100011,
3)	СВ1 = J0 = 0100 0100 0100 0001,
4)	У = У1, де У1 = S1Ф С1РНК (СВ1).
Застосувавши шифр mini-AES з ключем шифруван-ня К до блоку лiчильника СВ1, отримуемо наступний результат
С1РНК (СВ1 ) = 0110 0000 1111 1001,
У1 = S1Ф С1РНК (СВ1 ) =
=0101111000100011Ф0110000011111001=
= 0011111011011010.
Тобто У = 0011 1110 1101 1010.
4. 6. Заключне перетворення для формування тегу автентифжацп повщомлень шляхом обрiзання результату зашифрування до визначено! довжини
Для формування тегу автентифжацп Т зашифрований рядок обрiзаеться до визначе-но'1 довжини ^ Т = MSBt (GCTRK(J0,S)) . Для ви-конання цiеi операцii у зменшенш моделi режиму будемо застосовувати описаш ранiше зменшенi вер-сп криптоперетворень. Наприклад, сформуемо тег автентифiкацii при t = 13, а в якостi GCTRK (J0,S) виступае значення У = 00111110 11011010. Тда Т = MSB13 (У) = 00111110 11011 - у вiдповiдностi з виразом (8).
Таким чином, розроблена зменшена модель режиму GCM&GMAC зберiгае алгебра1чну структуру в«х основних криптоперетворень, що дозволяе за рахунок 1хнього масштабування проводити експерименталь-нi дослiдження колiзiйних властивостей формова-
них iMiтовставок з подальшим прогнозуванням рiвня криптографiчного стiйкостi повно! версп шифру.
5. Висновки
В данш роботi проведено аналiз алгоритму роботи режиму вибiркового гамування iз прискореним виро-бленням iмiтовставки вiдповiдно до NIST SP 800-38D. Проведення експериментальних дослщжень повно1 версп цього режиму для ощнки ймовiрностi виник-нення колiзiй при формування кодiв автентифжацп повiдомлень е неможливим з причини велико! розмiр-ностi оброблюваних блоюв даних. Рiшення цiеi задачi знайдено у розробщ зменшено! моделi вибiркового гамування iз прискореним виробленням iмiтовставки та представлено у цiй роботь
Як видно iз останнього прикладу розроблена змен-шена модель режиму GCM&GMAC дозволяе фор-мувати iмiтовставку визначено! довжини, при цьому зберпаеться вся алгебра!чна структура застосовува-них перетворень, тобто запропонована модель за видами перетворень виповщае рекомендацiям стандарту NIST SP 800-38D i вiдрiзняеться лише розрядшстю вiдповiдних блокiв, яка визначаеться встановленим коефвдентом масштабування. Це дозволяе стверджу-вати про адекватнiсть розроблено! моделi об'екту до-слiджень, наведеш приклади дозволяють переконати-ся у вщтворюваносп результатiв моделювання.
Таким чином, масштабування застосованих пе-ретворень на вщповщних етапах схеми формування кодiв автентифiкацii повiдомлень дозволяе побудува-ти зменшену модель GCM&GMAC, експериментально дослщити колiзiйнi властивостi сформованих кодiв. Коефвдент масштабування при розробцi мiнi-моделi GCM&GMAC обрано таким чином, щоб довжина сформованих Геш-кодiв S, псевдовипадково'^ послiдовностi
У та кодiв автентифжацп повiдомлень Т дорiвнюва-ла довжиш блоку мiнi-версii блокового симетрич-ного шифру AES [11], тобто 16 биам. Вибiр такого коефiцiенту масштабування дозволяе зберегти алге-браiчну структуру основних перетворень алгоритму GCM&GMAC, в тому чи^ i схему алгоритму AES, що в нього входить. Також це дае можлившть в по-дальшому провести експериментальнi дослщження з використанням методiв статистичноi перевiрки при-пущень, розглядаючи обмежений набiр елементiв S, У, Т та вщповщш результати з оцiнки числа колiзiй як вибiрку з генеральноi сукупностi. Проведення таких дослiджень е перспективним напрямком подальших робiт, що спрямоваш, зокрема, на обГрунтування реко-мендацiй та певних обмежень у застосуванш режиму вибiркового гамування iз прискореним виробленням iмiтовставки в Украшь
Лiтература
1.	ГОСТ 28147-89. Системы обработки информации. Защита криптографическая. Алгоритм криптографического преобразования [Текст]. - Введ. 199o-o7-o1. - М.: Изд-во стандартов, 1989. - 28 с.
2.	ГОСТ Р ИСО/МЭК Ю116-93. Информационная технология. Режимы работы для алгоритма n-разрядного блочного шифрования [Текст]. - Введ. 1993-12-28. - М.: Изд-во стандартов, 1994. - 2o с.
3.	ISO/IEC Ю116. Information technology - Security techniques - Modes of operation for an n-bit block cipher [Electronic resource]. -2oo6. - Available at: \www/URL: http://www.iso.org.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
17.
18.
19.
20.
21.
22.
23.
24.
25.
I
Dworkin, M. NIST Special Publication 800-38. Block Cipher Modes [Electronic resource] / M. Dworkin. - 2007. - Available at: \www/URL: http://csrc.nist.gov.
ДСТУ. 1нформацшш технологи. Криптографiчний захист шформацп. Алгоритм симетричного блокового перетворення [Текст]: Проект стандарту. - 2-га (остаточна) редакщя. - Кшв: Держспоживстандарт Украши, 2014. - 238 с. Розробка нового блокового симетричного шифру [Текст]: зв^ за перший етап НДР «Алгоритм» (промiжний) / кер. I. Д. Горбенко; АТ «IIT». - Харгав, 2014. - Том 4. - 304 с.
Кузнецов, О. О. Аналiз колiзiйних властивостей режиму вироблення iмiтовставок iз вибiрковим гамуванням [Текст] / О. О. Кузнецов, Д. В. 1ваненко, 6. П. Колованова // Вюник Харювського нацiонального унiверситету iм. В. Н. Каразша. Серiя «Математичне моделювання. Iнформацiйнi технологи. Автоматизованi системи управлшня». - 2014. - № 1097, Т. 23. - С. 55-71.
National Institute of Standards and Technology, FIPS 197 [Electronic resource]: Advanced Encryption Standard. - 2001. - Available at: \www/URL: http://www.nist.gov/aes.
Stinson, D. R. Universal hashing and authentication codes [Тех^ / D. R. Stinson // Designs, Codes and Cryptography. - 1994. -Vol. 4, № 3. - P. 369-380. doi:10.1007/bf01388651.
Polynomial hashing [Тех^ : 4,588,985 United States Patent: H 03 M 7/00, field of search 340/347 DD / Carter J. L., Wegman M. N.; International Business Machines Corporation, Armonk, N.Y. - filed Dec. 30, 1983 - May 13, 1986.
Phan, R.C.-W. Mini Advanced Encryption Standard (Mini-AES): A testbed for Cryptanalysis Students [Тех^ / Raphael Chung-Wei Phan // Cryptologia. - 2002. - Vol. 26, № 4. - P. 283-306. doi:10.1080/0161-110291890948.
Bellare, M. Keying hash functions for message authentication [Тех^ / M. Bellare, R. Canetti, H. Krawczyk // CRYPTO '96 Proceedings of the 16th Annual International Cryptology Conference on Advances in Cryptology. - 1996. - Vol. 1109. - P. 1-15. doi:10.1007/3-540-68697-5_1.
Igoe, K. AES Galois counter mode for the secure shell transport layer protocol [Electronic resource] / K. Igoe, J. Solinas // IETF Request for Comments 5647. - 2009. - Available at: \www/URL: http://tools.ietf.org/html/rfc5647. Law, L. Suite B cryptographic suites for IPsec [Electronic resource] / L. Law, J. Solinas // IETF Request for Comments 4869. -2007. - Available at: \www/URL: http://tools.ietf.org/html/rfc6379.
Salter, M. Suite B profile for transport layer security (TLS) [Electronic resource] / M. Salter, E. Rescorla, R. Housley // IETF Request for Comments 5430. - 2009. - Available at: \www/URL: http://tools.ietf.org/html/rfc5430.
Lemsitzer, S. Multi-gigabit GCM-AES Architecture Optimized for FPGAs [Тех^ / S. Lemsitzer, J. Wolkerstorfer, N. Felber, M. Braendli // Proceedings of the 9th international workshop on Cryptographic Hardware and Embedded Systems, CHES '07. -2007. - Vol. 4727. - P. 227-238. doi:10.1007/978-3-540-74735-2_16.
McGrew, D. A. The Galois/Counter Mode of Operation (GCM) [Тех^ / D. A. McGrew, J. Viega. - 2013. - 41 p. Kasper, E. Faster and Timing-Attack Resistant AES-GCM [Тех^ / E. Kasper, P. Schwabe // Cryptographic Hardware and Embedded Systems - CHES 2009, Lecture Notes in Computer Science. - 2009. - Vol. 5747. - P. 1-17. doi:10.1007/978-3-642-04138-9_1. Misdetection of MIPS endianness & How to get fast AES calls? [Electronic resource]. - 2010. - Available at: \www/URL: http:// groups.google.com/group/ cryptopp-users/msg/a688203c2314ef08.
Gueron, Sh. AES-GCM for Efficient Authenticated Encryption - Ending the Reign of HMAC-SHA-1? [Тех^ / Shay Gueron // Workshop on Real-World Cryptography. - Stanford University Jan. 9-11, 2013. - 32 p.
Gopal, V. Fast Cryptographic Computation on Intel Architecture Via Function Stitching [Electronic resource] / V. Gopal, W. Feghali, J. Guilford, E. Ozturk, G. Wolrich, M. Dixon, M. Locktyukhin, M. Perminov; Intel Corp. - 2010. - Available at: \www/ URL: http://download.intel.com/design/intarch/PAPERS/ 323686.pdf.
Manley, R. A Program Generator for Intel AES-NI Instructions [Тех^ / R. Manley, D. Gregg // Progress in Cryptology -INDOCRYPT 2010, Lecture Notes in Computer Science. - 2010. - Vol. 6498. - P. 311-327. doi:10.1007/978-3-642-17401-8_22. McGrew, D. A. The Security and Performance of the Galois/counter mode (GCM) of Operation [Тех^ / D. A. McGrew, J. Viega // Proceedings of INDOCRYPT 2004, Lecture Notes in Computer Science. - 2004. - Vol. 3348. - P. 343-355. doi:10.1007/978-3-540-30556-9_27.
Ferguson, N. Authentication Weaknesses in GCM [Electronic resource] / N. Ferguson // Microsoft Corp. - 2005. - Available at:
\www/URL: http://csrc.nist.gov/groups/ST/toolkit/BCM/documents/comments/CWC-GCM/Ferguson2.pdf.
Saarinen, M-J. O. Cycling Attacks on GCM, GHASH and Other Polynomial MACs and Hashes [Тех^ / Markku-Juhani
O. Saarinen // Fast Software Encryption. Lecture Notes in Computer Science. - 2012. - Vol. 7549. - P. 216-225. doi:10.1007/978-
3-642-34047-5_13.